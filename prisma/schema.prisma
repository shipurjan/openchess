generator client {
  provider = "prisma-client"
  output   = "../app/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

enum GameStatus {
  WAITING
  IN_PROGRESS
  FINISHED
  ABANDONED
}

enum GameResult {
  WHITE_WINS
  BLACK_WINS
  DRAW
}

model Game {
  id     String     @id @default(cuid())
  status GameStatus @default(WAITING)
  result GameResult?

  whiteToken String  @unique @default(cuid())
  blackToken String? @unique

  isPublic Boolean @default(false)

  timeInitialMs   Int @default(0)
  timeIncrementMs Int @default(0)

  moves Move[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Move {
  id     Int    @id @default(autoincrement())
  gameId String
  game   Game   @relation(fields: [gameId], references: [id])

  moveNumber Int
  notation   String // SAN notation (e.g. "e4", "Nf3")
  fen        String // Board state after this move

  createdAt DateTime @default(now())

  @@index([gameId])
}
